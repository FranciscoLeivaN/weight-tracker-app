name: Lighthouse CI

# Este workflow puede ser deshabilitado o mantenido separado
# para ejecutarse de manera manual o con menos frecuencia
on:
  workflow_dispatch:  # Solo se ejecuta manualmente
  # Opcional: ejecutar automáticamente en algunas condiciones
  # push:
  #   branches: [ main ]
  #   paths-ignore:
  #     - '**.md'
  #     - 'docs/**'

jobs:
  lighthouse:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4
      
      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '18'
          cache: 'npm'
          
      - name: Install dependencies
        run: npm ci
        
      # Opción 1: Usar el script specific para pruebas de rendimiento en CI
      - name: Run CI-safe performance test
        run: npm run test:ci:performance
        env:
          CI: true
          
      # Opción 2: Si necesitas ejecutar Lighthouse real (deshabilitado por defecto)
      # - name: Run Lighthouse CI
      #   run: |
      #     npm install -g @lhci/cli@0.12.x
      #     lhci autorun --config=./lighthouserc.json
      #   if: false  # Deshabilitado por defecto
